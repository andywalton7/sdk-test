


<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>PRO SDK</title>

    <style>
    </style>
    <link rel="stylesheet" media="screen" href="pub/css/screen.css">
    <link rel="stylesheet" media="screen" href="pub/css/screen_overrides.css">
    <link rel="stylesheet" media="print" href="pub/css/print.css">
    <link rel="stylesheet" media="print" href="pub/css/print_overrides.css">
    <link rel="stylesheet" media="screen" href="pub/css/darkula.css">
    <link rel="stylesheet" media="screen" href="pub/css/theme_overrides.css">
    
      <script src="source/javascripts/lib/_jquery.js"></script>
<script src="source/javascripts/lib/_energize.js"></script>
<script src="source/javascripts/app/_lang.js"></script>
<script src="source/javascripts/app/_toc.js"></script>
<script type="text/javascript">
$(function() {
  loadToc($('#toc'), '.toc-link', '.toc-list-h2, .toc-list-h3, .toc-list-h4, .toc-list-h5, .toc-list-h6', 10);
  setupLanguages($('body').data('languages'));
  $('.content').imagesLoaded( function() {
    recacheHeights();
    refreshToc();
  });
});

window.onpopstate = function() {
  activateLanguage(getLanguageFromQueryString());
};
</script>

    
    <meta name="theme-color" content="#F3F7F9" />
<!-- Renderer: Shins v2.3.2-4 -->
<!-- Generator: Widdershins v3.6.6 -->
  </head>

  <body data-languages="[&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="source/images/navbar.png" class="undefined" alt="Navigation">
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="source/images/logo.png" class="logo" alt="Logo">
      
        <div class="lang-selector">
          
            
              <a href="#" data-language-name="csharp">C#</a>
            
          
        </div>
      
      
      <div id="toc" class="toc-list-h1">
	  	<ul class="toc-list-h1">
        
          <li>
            <a href="#header" class="toc-h1 toc-link" data-title="SortedPRO SDK Docs">SortedPRO SDK Docs</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#sdk-architecture" class="toc-h2 toc-link" data-title="SDK Architecture">SDK Architecture</a>
                    
                  </li>
                
                  <li>
                    <a href="#dependency-injection" class="toc-h2 toc-link" data-title="Dependency Injection">Dependency Injection</a>
                    
                  </li>
                
                  <li>
                    <a href="#asynchronous-methods" class="toc-h2 toc-link" data-title="Asynchronous Methods">Asynchronous Methods</a>
                    
                  </li>
                
                  <li>
                    <a href="#api-docs" class="toc-h2 toc-link" data-title="API Docs">API Docs</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#sdk-quick-start" class="toc-h1 toc-link" data-title="SDK Quick Start">SDK Quick Start</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#sample-application" class="toc-h2 toc-link" data-title="Sample Application">Sample Application</a>
                    
                  </li>
                
                  <li>
                    <a href="#downloading-the-sdk" class="toc-h2 toc-link" data-title="Downloading the SDK">Downloading the SDK</a>
                    
                  </li>
                
                  <li>
                    <a href="#configuration" class="toc-h2 toc-link" data-title="Configuration">Configuration</a>
                    
                  </li>
                
                  <li>
                    <a href="#creating-a-consignment" class="toc-h2 toc-link" data-title="Creating a Consignment">Creating a Consignment</a>
                    
                  </li>
                
                  <li>
                    <a href="#allocating-a-consignment" class="toc-h2 toc-link" data-title="Allocating a Consignment">Allocating a Consignment</a>
                    
                  </li>
                
                  <li>
                    <a href="#getting-consignment-labels" class="toc-h2 toc-link" data-title="Getting Consignment Labels">Getting Consignment Labels</a>
                    
                  </li>
                
                  <li>
                    <a href="#manifesting-a-consignment" class="toc-h2 toc-link" data-title="Manifesting a Consignment">Manifesting a Consignment</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#use-cases" class="toc-h1 toc-link" data-title="Use Cases">Use Cases</a>
            
              <ul class="toc-list-h2">
                
                  <li>
                    <a href="#consumer-options" class="toc-h2 toc-link" data-title="Consumer Options">Consumer Options</a>
                    
                  </li>
                
                  <li>
                    <a href="#consumer-options-pickup" class="toc-h2 toc-link" data-title="Consumer Options Pickup">Consumer Options Pickup</a>
                    
                  </li>
                
                  <li>
                    <a href="#order-flex" class="toc-h2 toc-link" data-title="Order Flex">Order Flex</a>
                    
                  </li>
                
                  <li>
                    <a href="#consumer-options-flex" class="toc-h2 toc-link" data-title="Consumer Options Flex">Consumer Options Flex</a>
                    
                  </li>
                
                  <li>
                    <a href="#quotes" class="toc-h2 toc-link" data-title="Quotes">Quotes</a>
                    
                  </li>
                
              </ul>
            
          </li>
        
          <li>
            <a href="#sdk-reference" class="toc-h1 toc-link" data-title="SDK Reference">SDK Reference</a>
            
          </li>
        
		</ul>
      </div>
      
        <ul class="toc-footer">
          
        </ul>
      
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="header">SortedPRO SDK Docs</h1>
<p>Welcome to the SortedPRO SDK! Here youâ€™ll find a brief overview of the SDK and what you can do with it.</p>
<p>If you just want to get integrating, check out the <a href="https://pro-sdk-test.herokuapp.com/#sdk-quick-start">Quick Start</a> guide.</p>
<h3 id="in-this-section">In This Section</h3>
<ul>
<li><a href="https://pro-sdk-test.herokuapp.com/#sdk-architecture">SDK Architecture</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#dependency-injection">Dependency Injection</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#asynchronous-methods">Asynchronous Methods</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#api-docs">API Docs</a></li>
</ul>
<h2 id="sdk-architecture">SDK Architecture</h2>
<p>The SortedPRO SDK is a .Net Standard 2.x library that enables you to use PRO's functionality in your applications. It is split into a series of services, of which each publishes its own data contracts and &quot;mini-SDK&quot;. As such, you only need to reference the packages that you specifically require for your project, helping you to keep your dependency trees small.</p>
<h3 id="service-list">Service List</h3>
<p>The full list of services in the SDK is:</p>
<ul>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Consignments/">Consignments</a></strong> - Enables you to manage consignments, including creating, deleting, updating, and allocating to a carrier.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Labels/">Labels</a></strong> - Enables you to get consignment and packages labels</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Orders/">Orders</a></strong> - Enables you to manage PRO orders, including, creating, deleting, updating, and packing into consignments,</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Quotes/">Quotes</a></strong> - Enables you to get quotes based on a consignment reference or specific details.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Rates/">Rates</a></strong> - Enables you to reset the Rates cache.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Reconciliation/">Reconciliation</a></strong> - Enables you to get a list of invoices for a particular customer</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Security/">Security</a></strong> - Enables you to manage user accounts and configure roles.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Settings/">Settings</a></strong> - Enables you to administer your organisation's carriers, carrier services, collection calendars, packages sizes, service groups, and shipping locations.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Shared/">Shared</a></strong> - Contains shared components used by all PRO mini-SDKs.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Tracking/">Tracking</a></strong> - Enables you to get tracking events for your consignments.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Webhooks/">Webhooks</a></strong> - Enables you to configure push tracking notifications via webhook.</li>
<li><strong><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.XmlValidation/">XmlValidation</a></strong> - Enables you to get the embedded XML schema.</li>
</ul>
<p>When referencing a particular service, you must also reference its <code>DataTypes</code> (i.e. the data contract for that service) and <code>Interfaces</code>. For example, to use <code>Consignments</code> functionality you would need to reference the following:</p>
<ul>
<li><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Consignments/">Sorted.PRO.SDK.Consignments</a></li>
<li><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Interfaces.Consignments/">Sorted.PRO.SDK.Interfaces.Consignments</a></li>
<li><a href="https://www.nuget.org/packages/Sorted.PRO.SDK.DataTypes.Consignments/">Sorted.PRO.SDK.DataTypes.Consignments</a></li>
</ul>
<p>Alternatively, you can reference the master package set, <a href="https://www.nuget.org/packages/Sorted.PRO.SDK/">Sorted.PRO.SDK</a>. This package set references all of PRO's &quot;mini-SDKs&quot;, enabling you to consume the SDK with minimal package references and without requiring knowledge of the individual services.</p>
<h3 id="common-dependencies">Common Dependencies</h3>
<p>Many of the &quot;mini-SDK&quot; packages are dependent on a common SDK, which can be referenced at <a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Shared/">Sorted.PRO.SDK.Shared</a> and <a href="https://www.nuget.org/packages/Sorted.PRO.SDK.DataTypes.Common/">Sorted.PRO.SDK.DataTypes.Common</a>. See the SDK reference documentation for specific dependency information.</p>
<p>The following dependencies are common to almost all of the services in the PRO SDK. They are located in the <a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Shared/">Sorted.PRO.SDK.Shared</a> package:</p>
<ul>
<li>
<p><code>ILogger</code> - Responsible for logging diagnostic information. Implementing <code>ILogger</code> enables you to connect to PRO's inbuilt logging. For example, you could provide an implementation that writes PRO logging messages into your own logging pipeline. Alternatively, you can use the provided <code>SdkReferenceLogger</code>, which logs to the console.</p>
</li>
<li>
<p><code>IHttpClientFactory</code> - Responsible for efficient re-use of HTTP connections. The <a href="https://www.nuget.org/packages/Sorted.PRO.SDK.Shared/">Sorted.PRO.SDK.Shared</a> package includes a default implementation called <code>HttpClientFactory</code>. We recommend that you use the provided implementation, rather than implementing this interface yourself.</p>
</li>
<li>
<p><code>IEndpoints</code> - Enables you to specify the locations that the SDK sends HTTP requests to. For example, you might want to implementing <code>IEndpoints</code> yourself in order to have PRO send requests to your own internal systems for testing purposes. The SDK includes default implementations for production (<code>Production.Instance</code>) and sandbox (<code>Sandbox.Instance</code>) environments.</p>
</li>
</ul>
<h2 id="dependency-injection">Dependency Injection</h2>
<p>The PRO SDK is designed to be used with a dependency injection framework. All services have a corresponding interface, named with the <code>I{serviceName}</code> convention. For example, to create consignments you would use the <code>IConsignmentService</code> interface, which is in turn implemented by the concrete <code>ConsignmentService</code> class.</p>
<h2 id="asynchronous-methods">Asynchronous Methods</h2>
<p>The SDK includes both synchronous and asynchronous methods. The synchronous methods are only included to support scenarios where it is not possible for you to use asynchronous code, and will be deprecated in a future version of the SDK.</p>
<aside class="note">
   We <strong>strongly</strong> recommend that you only utilise the SDK's asynchronous methods, as this will enable you to achieve far higher throughput on your own systems. Using synchronous methods can cause serious threading issues if you do not take steps to avoid this when developing your application.
</aside>   
<h2 id="api-docs">API Docs</h2>
<p>For further information on PRO's APIs, see the <a href="https://docs.electioapp.com/#/api">API Reference</a> and PRO Call Flow documentation.</p>
<h1 id="sdk-quick-start">SDK Quick Start</h1>
<p>Ready to get started with the SortedPRO SDK? This page explains how to set the SDK up and create a simple app to create, allocate, get labels for, and manifest a consignment.</p>
<p>This page is based on PRO's <strong>Classic</strong> workflow. For more information on this workflow, see the <a href="https://sorted-pro-flows-demo.herokuapp.com/#classic-flow">PRO Call Flow</a> docs.</p>
<h3 id="on-this-page">On This Page</h3>
<ul>
<li><a href="https://pro-sdk-test.herokuapp.com/#sample-application">Sample Application</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#downloading-the-sdk">Downloading the SDK</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#configuration">Configuration</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#creating-a-consignment">Creating a Consignment</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#allocating-a-consignment">Allocating a Consignment</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#getting-consignment-labels">Getting Consignment Labels</a></li>
<li><a href="https://pro-sdk-test.herokuapp.com/#manifesting-a-consignment">Manifesting a Consignment</a></li>
</ul>
<h2 id="sample-application">Sample Application</h2>
<p>This guide is intended to be used in conjunction with the Classic Flow sample application, available from [LINK HERE]. This app shows the <strong>Classic</strong> PRO workflow implemented using the PRO SDK.</p>
<h2 id="downloading-the-sdk">Downloading the SDK</h2>
<p>The PRO SDK is available as a collection of NuGet packages. For information on the specific packages you need for your project, see the SDK reference docs and the SDK Architecture section of the About the SDK page.</p>
<p>Alternatively, you can reference the master package set, <a href="https://www.nuget.org/packages/Sorted.PRO.SDK/">Sorted.PRO.SDK</a>. This package set references all of PRO's &quot;mini-SDKs&quot;, enabling you to consume the entire SDK with minimal package references and without requiring knowledge of its individual services.</p>
<aside class="info">
   For help on consuming packages from NuGet, see the <a href="https://docs.microsoft.com/en-us/nuget/consume-packages/overview-and-workflow">NuGet documentation</a>.
</aside>   
<h2 id="configuration">Configuration</h2>
<blockquote>
<p>Registering API Keys</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> Register the Sorted.PRO services</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> The  used to get app configuration</span>
<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">RegisterServices</span>(<span class="hljs-params">IConfigurationRoot configuration</span>)
</span>{
    <span class="hljs-comment">//using an extension method to register these services</span>
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
    _container.RegisterApiKeyDependentService(configuration);
}
</code></pre>
<p>Many of the SDK's services require an <code>apiKey</code> as a dependency. The sample application demonstrates how to use an extension method to register those services that are dependent on an <code>apiKey</code>.</p>
<h2 id="creating-a-consignment">Creating a Consignment</h2>
<p>Many of PRO's key workflows require you to create a consignment object as an initial step. The <code>CreateConsignmentSample.cs</code> sample application file demonstrates how to create a consignment using the SDK.</p>
<p>In the PRO SDK, consignments are created by sending a <code>CreateConsignmentRequest</code> object to the <a href="https://docs.electioapp.com/#/api/CreateConsignment">Create Consignment</a> endpoint via the <code>IConsignmentService.CreateConsignmentAsync(request)</code> method. The basic steps to create a consignment via the SDK are:</p>
<blockquote>
<p>New IConsignmentService</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">CreateConsignmentSample</span> : <span class="hljs-title">ICreateConsignmentSample</span>
{
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IConsignmentService _consignmentService;
   <span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ISortedConfiguration _configuration;

   <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">CreateConsignmentSample</span>(<span class="hljs-params">
      IConsignmentService consignmentService,
      ISortedConfiguration configuration</span>)
   </span>{
      _consignmentService = consignmentService;
      _configuration = configuration;
}
</code></pre>
<ol>
<li>Create a new instance of the <code>IConsignmentService</code>. In the sample application, this is done via dependency injection.</li>
</ol>
<blockquote>
<p>CreateConsignmentRequest</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">public</span> CreateConsignmentRequest <span class="hljs-title">BuildCreateConsignmentRequest</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> postcode</span>)
</span>{   
   <span class="hljs-keyword">var</span> createConsignmentRequest = <span class="hljs-keyword">new</span> CreateConsignmentRequest
   {
      Direction = ConsignmentDirection.Outbound,
      Addresses = <span class="hljs-keyword">new</span> List <span class="hljs-comment">//all consignments must have at least 2 addresses</span>
      {
            <span class="hljs-keyword">new</span> Address
            {
               ShippingLocationReference = _configuration.ShippingLocationReference,
               AddressType = ConsignmentAddressType.Origin <span class="hljs-comment">//must include an origin address</span>
            },
            <span class="hljs-keyword">new</span> Address
            {
               AddressType = ConsignmentAddressType.Destination, <span class="hljs-comment">//must include a destination address</span>
               AddressLine1 = <span class="hljs-string">"123 Some Street"</span>,
               Town = <span class="hljs-string">"Manchester"</span>,
               Region = <span class="hljs-string">"Greater Manchester"</span>,
               Postcode = postcode,
               Country = <span class="hljs-keyword">new</span> Country(<span class="hljs-string">"GB"</span>),
               Contact = <span class="hljs-keyword">new</span> Contact()
               {
                  Title = <span class="hljs-string">"Mr"</span>,
                  FirstName = <span class="hljs-string">"Tester"</span>,
                  LastName = <span class="hljs-string">"McTest"</span>,
                  Email = <span class="hljs-string">"tester.mctest@sorted.com"</span>,
                  Telephone = <span class="hljs-string">"0161123456"</span>
               }
            }
      },
      Packages = <span class="hljs-keyword">new</span> List
      {
            <span class="hljs-keyword">new</span> Package
            {
               Weight = <span class="hljs-keyword">new</span> Weight(<span class="hljs-number">1.5</span>M),
               Dimensions = <span class="hljs-keyword">new</span> Dimensions(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-number">10</span>),
               Description = <span class="hljs-string">"A sample package"</span>,
               Value = <span class="hljs-keyword">new</span> Money(<span class="hljs-keyword">new</span> Currency(<span class="hljs-string">"GBP"</span>), <span class="hljs-number">2.99</span>M),
               PackageReferenceProvidedByCustomer = Guid.NewGuid().ToString()
            }
      },
      ConsignmentReferenceProvidedByCustomer = <span class="hljs-string">"my_reference"</span>
   };

   <span class="hljs-keyword">return</span> createConsignmentRequest;
}
</code></pre>
<ol start="2">
<li>
<p>Create a new <code>CreateConsignmentRequest</code>. This object contains the details of the consignment to be created. For details on the structure of the <code>CreateConsignmentRequest</code>, see SDK REFERENCE LINK HERE.
The example to the right shows a simple consignment request for an outbound shipment containing a single package.</p>
</li>
<li>
<p>Use the <code>IConsignmentService.CreateConsignmentAsync(request)</code> method to pass the <code>CreateConsignmentRequest</code> to the <a href="https://docs.electioapp.com/#/api/CreateConsignment">Create Consignment</a> API endpoint . PRO creates the consignment based on the details in the <code>CreateConsignmentRequest</code>and returns an <code>apiLink</code> detailing the consignment's reference and a link to the full consignment details.</p>
</li>
</ol>
<blockquote>
<p>ExtractConsignmentReference</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">ExtractConsignmentReference</span>(<span class="hljs-params">ApiLink apiLink</span>)
</span>{
   <span class="hljs-keyword">var</span> href = apiLink.Href;
   <span class="hljs-keyword">var</span> regex = <span class="hljs-keyword">new</span> Regex(<span class="hljs-string">"EC-[A-Z0-9]{3}-[A-Z0-9]{3}-[A-Z0-9]{3}$"</span>);
   <span class="hljs-keyword">var</span> match = regex.Match(href);
   <span class="hljs-keyword">if</span> (!match.Success)
   {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Exception(<span class="hljs-string">$"Could not extract consignment reference from apiLink <span class="hljs-subst">{href}</span>"</span>);
   }

   <span class="hljs-keyword">return</span> match.Value;
}
</code></pre>
<ol start="4">
<li>Extract the consignment reference from the API's response. PRO consignment references are a unique identifier for each consignment in the system, and have the format <code>EC-XXX-XXX-XXX</code>. The code sample to the right uses a regular expression to extract the consignment reference from the API's response.</li>
</ol>
<h2 id="allocating-a-consignment">Allocating a Consignment</h2>
<p>Once you've created a consignment, it must be allocated to a carrier service. PRO has multiple allocation endpoints, giving you the flexibility to allocate to carriers using whatever criteria suits you best.</p>
<p>This example and the <code>AllocateConsignmentSample.cs</code> sample application file demonstrates how to allocate a consignment using the <strong>Allocate With Default Rules</strong> endpoint, which allocates the consignment to the cheapest service that meets your organisation's allocation rules. For more information on PRO's other allocation options, see the <a href="https://docs.electioapp.com/#/api/AllocateConsignment">API Reference</a>.</p>
<aside class="note">
   In the context of SortedPRO, **allocation** is the process of selecting the carrier service that will be used to deliver the consignment.
</aside>   
<p>In the PRO SDK, consignments can be allocated by passing a consignment reference to the <a href="https://docs.electioapp.com/#/api/AllocateConsignment">Allocate Consignment</a> endpoint via the <code>IConsignmentAllocationService.AllocateConsignmentAsync(reference)</code> method. The basic steps to allocate a consignment via the SDK are:</p>
<blockquote>
<p>Creating IAllocationService</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IConsignmentAllocationService _consignmentAllocationService;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">AllocateConsignmentSample</span>(<span class="hljs-params">IConsignmentAllocationService consignmentAllocationService</span>)
</span>{
   _consignmentAllocationService = consignmentAllocationService;
}
</code></pre>
<ol>
<li>Create a new instance of the <code>IConsignmentAllocationService</code>. In the sample application, this is done via dependency injection.</li>
</ol>
<blockquote>
<p>AllocateConsignmentAsync method</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">AllocateConsignment</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> consignmentReference</span>)
</span>{
   <span class="hljs-keyword">return</span> <span class="hljs-keyword">await</span> OperationHelper.Execute(<span class="hljs-keyword">async</span> () =&gt;
   {
      <span class="hljs-keyword">var</span> allocationResult =
            <span class="hljs-keyword">await</span> _consignmentAllocationService.AllocateConsignmentAsync(consignmentReference);
      JsonSampler.SummariseToJson(allocationResult);
      <span class="hljs-keyword">var</span> first = allocationResult.FirstOrDefault();
      WriteAllocationSummary(first);
      <span class="hljs-keyword">return</span> first;
   });
}
</code></pre>
<ol start="2">
<li>
<p>Use the <code>IConsignmentAllocationService.AllocateConsignmentAsync(reference)</code> method to pass a consignment reference to the <a href="https://docs.electioapp.com/#/api/AllocateConsignment">Allocate Consignment</a> API endpoint.</p>
<p>PRO allocates the consignment and returns an <code>AllocationSummary</code>, which contains links to the consignment resource that was allocated, a summary of the carrier service that the consignment was allocated to, a link to the relevant package labels, and a <code>ConsignmentLegs</code> array indicating how many legs the shipment will need.</p>
</li>
</ol>
<blockquote>
<p>Reading the AllocationSummary</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteAllocationSummary</span>(<span class="hljs-params">AllocationSummary summary</span>)
</span>{
   WriteProperty(<span class="hljs-string">"Carrier name"</span>, summary.CarrierName);
   WriteProperty(<span class="hljs-string">"Carrier reference"</span>, summary.CarrierReference);
   WriteProperty(<span class="hljs-string">"Carrier service"</span>, summary.CarrierServiceName);
   WriteProperty(<span class="hljs-string">"Carrier service reference"</span>, summary.CarrierServiceReference);
   WriteProperty(<span class="hljs-string">"Description"</span>, summary.Description);
}

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">WriteProperty</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> property, <span class="hljs-keyword">string</span> <span class="hljs-keyword">value</span></span>)
</span>{
   Console.WriteLine(<span class="hljs-string">$"Property '<span class="hljs-subst">{property}</span>' has value '<span class="hljs-subst">{<span class="hljs-keyword">value</span>}</span>'"</span>);
}
</code></pre>
<ol start="3">
<li>Read the <code>AllocationSummary</code> object to find the details of the carrier name, reference, service and service name.</li>
</ol>
<p>Once allocated, the consignment's status changes to <em>Allocated</em>.</p>
<h2 id="getting-consignment-labels">Getting Consignment Labels</h2>
<p>When a consignment is allocated, SortedPRO generates labels for each package in that consignment. The next step in the process is to retrieve those delivery labels. This example and the <code>GetLabelsSample.cs</code> sample application file demonstrates how to retrieve labels using the <code>LegacyLabelService</code>.</p>
<p>The basic steps to get consignment labels via the SDK are:</p>
<blockquote>
<p>Creating ILegacyLabelService</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> ILegacyLabelService _legacyLabelService;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">GetLabelsSample</span>(<span class="hljs-params">ILegacyLabelService legacyLabelService</span>)
</span>{
   _legacyLabelService = legacyLabelService;
}
</code></pre>
<ol>
<li>Create a new instance of the <code>ILegacyLabelService</code>. In the sample application, this is done via dependency injection.</li>
</ol>
<blockquote>
<p>AllocateConsignmentAsync(reference, format) method</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">GetLabels</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> consignmentReference, <span class="hljs-keyword">bool</span> open = <span class="hljs-literal">true</span></span>)
</span>{
   <span class="hljs-keyword">await</span> OperationHelper.Execute(<span class="hljs-keyword">async</span> () =&gt;
   {
      <span class="hljs-keyword">var</span> labelData = <span class="hljs-keyword">await</span> _legacyLabelService.GetLabelsAsync(consignmentReference, labelFormat);
      SummariseLabels(labelData);
      JsonSampler.SummariseToJson(labelData);
      <span class="hljs-keyword">if</span> (open)
      {
            OpenLabel(labelData, consignmentReference);
      }
   });
}      
</code></pre>
<ol start="2">
<li>
<p>Use the <code>ConsignmentAllocationService.AllocateConsignmentAsync(reference, format)</code> method to pass a <code>consignmentReference</code> and (optionally) a <code>labelFormat</code> to the <a href="https://docs.electioapp.com/#/api/AllocateConsignment">Allocate Consignment</a> API endpoint.</p>
<p>PRO returns a <code>GetLabelsResponse</code> containing all package labels associated with the specified consignment as a base64-encoded byte array in the format requested.</p>
</li>
</ol>
<blockquote>
<p>Saving the Label File</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">string</span> <span class="hljs-title">SaveFile</span>(<span class="hljs-params"><span class="hljs-keyword">byte</span>[] contents, <span class="hljs-keyword">string</span> consignmentReference</span>)
</span>{
   <span class="hljs-keyword">try</span>
   {
      <span class="hljs-keyword">var</span> path = System.IO.Path.GetTempPath();
      <span class="hljs-keyword">var</span> fileName = <span class="hljs-string">$"<span class="hljs-subst">{Guid.NewGuid():N}</span>-<span class="hljs-subst">{consignmentReference}</span>.pdf"</span>;
      <span class="hljs-keyword">var</span> filePath = System.IO.Path.Combine(path, fileName);
      System.IO.File.WriteAllBytes(filePath, contents);
      <span class="hljs-keyword">return</span> filePath;
   }
   <span class="hljs-keyword">catch</span> (Exception e)
   {
      Console.WriteLine(e);
      <span class="hljs-keyword">throw</span>;
   }
}    
</code></pre>
<ol start="3">
<li>Save the file to disk or to a remote location.</li>
</ol>
<h2 id="manifesting-a-consignment">Manifesting a Consignment</h2>
<p>Once you've created a consignment, allocated it to a carrier service and printed labels for it, you're ready to manifest it. The <code>ManifestSample.cs</code> sample application file demonstrates how to manifest a consignment using the SDK.</p>
<aside class="note">
   In the context of SortedPRO, the term "manifest" refers to advising the carrier that the consignment in question needs to be collected from the shipper.
</aside>   
<p>In the PRO SDK, consignments are manifested by sending a <code>ManifestConsignmentsRequest</code> object to the <a href="https://docs.electioapp.com/#/api/ManifestConsignments">Manifest Consignments</a> endpoint via the <code>IConsignmentService.ManifestConsignmentsAsync(request)</code> method. The basic steps to manifest a consignment via the SDK are:</p>
<blockquote>
<p>Creating IConsignmentService</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-keyword">private</span> <span class="hljs-keyword">readonly</span> IConsignmentService _consignmentService;

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">ManifestSample</span>(<span class="hljs-params">IConsignmentService consignmentService</span>)
</span>{
   _consignmentService = consignmentService;
}
</code></pre>
<ol>
<li>
<p>Create a new instance of <code>IConsignmentService</code>. In the sample application, this is done via dependency injection.</p>
</li>
<li>
<p>Construct a new <code>ManifestConsignmentsRequest</code>. This object contains the references of the consignments to be manifested. For details on the structure of the <code>ManifestConsignmentsRequest</code>, see LINK HERE.</p>
</li>
</ol>
<blockquote>
<p>ManifestConsignmentsAsync(request) method</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> Task <span class="hljs-title">ManifestConsignment</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> consignmentReference</span>)
</span>{
   <span class="hljs-keyword">await</span> OperationHelper.Execute(<span class="hljs-keyword">async</span> () =&gt;
   {
      <span class="hljs-keyword">var</span> result = <span class="hljs-keyword">await</span> _consignmentService.ManifestConsignmentsAsync(<span class="hljs-keyword">new</span> ManifestConsignmentsRequest()
      {
            ConsignmentReferences = <span class="hljs-keyword">new</span> List
            {
               consignmentReference
            }
      });
      PrintResults(result);
      JsonSampler.SummariseToJson(result);
   });
</code></pre>
<ol start="3">
<li>
<p>Use the <code>IConsignmentService.ManifestConsignmentsAsync(request)</code> method to pass the <code>ManifestConsignmentsRequest</code> to the <a href="https://docs.electioapp.com/#/api/ManifestConsignments">Manifest Consignments</a> endpoint.</p>
<p>PRO attempts to manifest all of the consignments in the request, and returns a message indicating how many consignments could be manifested.</p>
</li>
</ol>
<blockquote>
<p>Print Results</p>
</blockquote>
<pre class="highlight tab tab-csharp"><code><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">PrintResults</span>(<span class="hljs-params">IEnumerable&gt; manifestResponse</span>)
</span>{
   <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> result <span class="hljs-keyword">in</span> manifestResponse)
   {
      Console.WriteLine(<span class="hljs-string">$"Manifested: <span class="hljs-subst">{result.IsSuccess}</span>. Message: <span class="hljs-subst">{result.Message}</span>"</span>);
   }
}
</code></pre>
<ol start="4">
<li>View the results of the operation.</li>
</ol>
<p>We have only scratched the surface of what you can do with the PRO SDK in this tutorial. Read on to learn how to manage orders, quotes, and delivery options.</p>
<h1 id="use-cases">Use Cases</h1>
<h2 id="consumer-options">Consumer Options</h2>
<h2 id="consumer-options-pickup">Consumer Options Pickup</h2>
<h2 id="order-flex">Order Flex</h2>
<h2 id="consumer-options-flex">Consumer Options Flex</h2>
<h2 id="quotes">Quotes</h2>
<h1 id="sdk-reference">SDK Reference</h1>
<!-- Renderer: Shins v2.3.2-4 -->
<!-- Generator: Widdershins v3.6.6 -->
      </div>
      <div class="dark-box">
        
          <div class="lang-selector">
            
              
                <a href="#" data-language-name="csharp">C#</a>
              
            
          </div>
        
      </div>
    </div>
  </body>
</html>
